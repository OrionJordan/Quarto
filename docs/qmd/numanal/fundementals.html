<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>OOMN - Fundementals</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">OOMN</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../qmd/graph/GraphTheory.html" rel="" target="">
 <span class="menu-text">Graph Theory</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../qmd/integral/intro.html" rel="" target="">
 <span class="menu-text">Integral</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../qmd/logic/intro.html" rel="" target="">
 <span class="menu-text">Mathematical Logic</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#floating-point" id="toc-floating-point" class="nav-link active" data-scroll-target="#floating-point">Floating point</a>
  <ul class="collapse">
  <li><a href="#loss-of-signifigance" id="toc-loss-of-signifigance" class="nav-link" data-scroll-target="#loss-of-signifigance">Loss of signifigance</a></li>
  <li><a href="#rounding" id="toc-rounding" class="nav-link" data-scroll-target="#rounding">Rounding</a></li>
  </ul></li>
  <li><a href="#taylor-series" id="toc-taylor-series" class="nav-link" data-scroll-target="#taylor-series">Taylor series</a></li>
  <li><a href="#newtons-method" id="toc-newtons-method" class="nav-link" data-scroll-target="#newtons-method">Newtons method</a></li>
  <li><a href="#interpolation" id="toc-interpolation" class="nav-link" data-scroll-target="#interpolation">Interpolation</a></li>
  <li><a href="#error" id="toc-error" class="nav-link" data-scroll-target="#error">Error</a></li>
  <li><a href="#multi-panel-integration-formula" id="toc-multi-panel-integration-formula" class="nav-link" data-scroll-target="#multi-panel-integration-formula">Multi-panel integration formula</a></li>
  <li><a href="#simpson-integration" id="toc-simpson-integration" class="nav-link" data-scroll-target="#simpson-integration">Simpson integration</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Fundementals</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="floating-point" class="level2">
<h2 class="anchored" data-anchor-id="floating-point">Floating point</h2>
<p>Computers don’t use exact numbers when preforming calculations, but instead use a floating point system.</p>
<div class="callout callout-style-default callout-note no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Definition
</div>
</div>
<div class="callout-body-container callout-body">
<p>A <span style="color: blue"><strong>floating point</strong></span> number <span class="math inline">x</span> is expressed as</p>
<p><span class="math display">
x = S \times 2^E \times 1.b_1b_2\ldots b_{52}
</span></p>
<p>Such that <span class="math inline">S</span> represents the sign of the number, <span class="math inline">+</span> or <span class="math inline">-</span>. <span class="math inline">E</span> is an exponent, and <span class="math inline">b_1</span> through <span class="math inline">b_52</span> are binary digits.</p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Suppose we have a variable <span class="math inline">x = 6</span> and we wish to express it as a floating point number. We first convert the number to binary</p>
<p><span class="math display">
6_{10} = 110_{2}
</span></p>
<p>We now specify where the decimal is, by adding an exponent</p>
<p><span class="math display">
6_{10} = 110_{2} = 2^2\times1.10_2
</span></p>
<p>And finally adding the sign</p>
<p><span class="math display">
6_{10} = 110_{2} = 1\times2^2\times1.10_2
</span></p>
</div>
</div>
<p>We can also express fractions, particular ones without a terminating digit. For example,</p>
<p><span class="math display">
0.3 = 1 \times 2^{-2} \times 1.00110011001\ldots
</span></p>
<p>Terminating after <span class="math inline">52</span> digits.</p>
<section id="loss-of-signifigance" class="level3">
<h3 class="anchored" data-anchor-id="loss-of-signifigance">Loss of signifigance</h3>
<p>Computers themselves store numbers as a collection of <span class="math inline">64</span> bits</p>
<p><span class="math display">
x = s_1e_1\ldots e_{11}m_1\ldots m_{52}
</span></p>
<p>One bit for the sign of a number, <span class="math inline">11</span> bits for the exponent, and <span class="math inline">52</span> bits for the mantissa (digits after the decimal place).</p>
<p>Clearly this means that only a finite amount of numbers can be expressed in floating point, and numbers are rounded to their nearest corresponding floating point. This leads to a <span style="color: blue"><strong>loss of signifigance</strong></span>, and means functions with extremly large or small inputs will be catastrophically wrong, as the difference between two numbers is completly outside of the range floating point can represent.</p>
<p>Take the identical functions <span class="math inline">f(x)</span> and <span class="math inline">g(x)</span></p>
<p><span class="math display">
f(x) = \frac{1 - \cos(x)}{\sin^2(x)}
</span></p>
<p><span class="math display">
g(x) = \frac{1}{1 + \cos(x)}
</span></p>
<p><span class="math inline">f(x)</span> suffers from an egregious loss of signifigance error as <span class="math inline">x</span> decreases towards <span class="math inline">0</span>, But <span class="math inline">g(x)</span> won’t.</p>
</section>
<section id="rounding" class="level3">
<h3 class="anchored" data-anchor-id="rounding">Rounding</h3>
<p>The number <span class="math inline">101.101</span> rounds up to <span class="math inline">110</span>, because the digits after the decimal are above <span class="math inline">.1</span>. If they aren’t the number terminates at the decimal. If <span class="math inline">101.1\overline{0}</span> then we get <span class="math inline">110</span>, but if we have <span class="math inline">110.1\overline{0}</span>, we drop the number. This is based on the digit in the units place. If it is a <span class="math inline">1</span>, we round up, if it is not, we drop it.</p>
</section>
</section>
<section id="taylor-series" class="level2">
<h2 class="anchored" data-anchor-id="taylor-series">Taylor series</h2>
<p>The <span style="color: blue"><strong>taylor expansion</strong></span> of a function <span class="math inline">f(x)</span> is given by</p>
<p><span class="math display">
f(x) = \sum^m_{k=0} \frac{f^{(k)}(x)(x-x_0)^k}{k!} + \frac{f^{(m + 1)}(c)(x-x_0)^{m+1}}{(m+1)!}
</span></p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Take the function <span class="math inline">f(x) = e^x</span> We can taylor expand it to get</p>
<p><span class="math display">
f(x) = e^x = 1 + \frac{x}{1!} + \frac{x^2}{2!} + \cdots + \frac{x^k}{k!} + \frac{e^cx^{k+1}}{k+1!}
</span></p>
</div>
</div>
<p>We can also write the Taylor series</p>
<p><span class="math display">
f(x + h) = \sum^m_{k=0} \frac{h^kf^{(k)}(x)}{k!}
</span></p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find the error</p>
<p><span class="math display">\begin{align*}
y^\prime(x) &amp;= ay(x) + by(x + h) + \varepsilon\\
y^\prime(x) &amp;= ay(x) + b\left(y(x) - hy^\prime(x) + \frac{h^2}{2}y^{\prime\prime}(c_1)\right) + \varepsilon\\
y^\prime(x) &amp;= (a+b)y(x) - bhy^\prime(x) + \frac{bh^2}{2}y^{\prime\prime}(c_1) + \varepsilon\\
\end{align*}</span></p>
<p>So</p>
<p><span class="math display">
a = -b\quad b = -\frac{1}{h}\quad
</span></p>
<p>Thus we get</p>
<p><span class="math display">
y^\prime(x) = \frac{y(x+h) - y(x)}{h} + \varepsilon
</span></p>
<p>with an error <span class="math display">
\varepsilon = -\frac{h}{2}y^{\prime\prime}(c_1).
</span></p>
</div>
</div>
<p>When we plug these numbers into the computer however, we are going to have an error as we have only <span class="math inline">52</span> digits of precision. This gives us the machine error <span class="math inline">\epsilon</span>. So if we wanted to numerically approximate the derivative</p>
<p><span class="math display">
y^\prime(x) = \frac{y(x+h) - y(x) + 2\epsilon y}{h} + \varepsilon
</span></p>
<p>This gives us the total error, the sum of the machine error, and the taylor error.</p>
<p><span class="math display">
\varepsilon_T = \epsilon + \varepsilon
</span></p>
<p><span class="math display">
\varepsilon_T = \frac{2\epsilon |y|}{2h} + \frac{2h^2}{12}|y^{\prime\prime\prime}(x)|
</span></p>
<p>By computing the derivative, we can find the smallest total error.</p>
<p><span class="math display">
\frac{d\varepsilon_T}{dh} = -\frac{1}{h^2}\epsilon |y| + \frac{h}{3}|y^{\prime\prime\prime}| = 0
</span></p>
<p>Solving for <span class="math inline">h</span></p>
<p><span class="math display">
h_{opt} =\left(\frac{3\epsilon |y|}{|y^{\prime\prime\prime}|}\right)^\frac{1}{3}
</span></p>
<p>For example, lets try the function <span class="math inline">y = e^x</span>. This gives us an optimal error</p>
<p><span class="math display">
h_{opt} = \left( 3 \times 2^{-52} \frac{e^x}{e^x} \right)^\frac{1}{3}
</span></p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Lets find the optimal value of <span class="math inline">h</span> using a different error.</p>
<p><span class="math display">
\varepsilon = -\frac{h}{2}y^{\prime\prime}(c_1)
</span></p>
<p>We can rewrite our equation</p>
<p><span class="math display">
y^\prime(x) = \frac{y(x+h) - y(x) + 2\epsilon y}{h} + -\frac{h}{2}y^{\prime\prime}(c_1)
</span></p>
<p>Then</p>
<p><span class="math display">
\varepsilon_T = \frac{2\epsilon |y|}{h} + \frac{h}{2}y^{\prime\prime}
</span></p>
<p>Taking the derivative</p>
<p><span class="math display">
\frac{d \varepsilon_T}{dh} = -\frac{2\epsilon |y|}{h^2} + \frac{1}{2}y^{\prime\prime} = 0
</span></p>
<p>We get</p>
<p><span class="math display">
\frac{2\epsilon |y|}{h^2} = \frac{1}{2}y^{\prime\prime}
</span></p>
<p>Thus</p>
<p><span class="math display">
h_{opt} = \left(\frac{4\epsilon |y|}{|y^{\prime\prime}|}\right)^\frac{1}{2}
</span></p>
</div>
</div>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Lets find the error of the following expression</p>
<p><span class="math display">
y^{\prime\prime} = ay(x-h) + by(x) + cy(x+h) + \varepsilon\\
</span></p>
<p><span class="math display">\begin{align*}
y^{\prime\prime} &amp;= a\left(y(x)-hy^\prime(x) + \frac{h^2}{2}y^{\prime\prime}(x) - \frac{h^3}{6}y^{\prime\prime\prime}(x) + \frac{h^4}{4!}y^{(4)}(x) \right)\\
&amp;+ by(x) \\
&amp;+ c\left(y(x)+hy^\prime(x) + \frac{h^2}{2}y^{\prime\prime}(x) + \frac{h^3}{6}y^{\prime\prime\prime}(x) + \frac{h^4}{4!}y^{(4)}(x) \right)
\end{align*}</span></p>
<p>Thus</p>
<p><span class="math display">\begin{align*}
(a + b + c) = 0\\
h(c-a) = 0\\
\frac{h^2}{2}(a-c) = 1
\end{align*}</span></p>
<p>Thus we have constants</p>
<p><span class="math display">
c = a\quad a = \frac{1}{h^2} \quad b = -\frac{2}{h^2}
</span></p>
<p>And we’re left with the error</p>
<p><span class="math display">\begin{align*}
\varepsilon = -\frac{h^2}{2y}\left(y^{(4)}(c_1)+y^{(4)}(c_2)\right)
\end{align*}</span></p>
<p>Thus we have</p>
<p><span class="math display">
y^{\prime\prime}(x) = \frac{y(x-h)-2y(x)+y(x+h)}{h^2} + \varepsilon
</span></p>
<p>Lets find the optimal error. First we include the machine error</p>
<p><span class="math display">
\epsilon_m = \frac{4\epsilon |y|}{h^2}
</span></p>
<p>Combine with our function error <span class="math display">
\varepsilon_{T} = \frac{4\epsilon |y|}{h^2} +  \frac{h^2}{2y}\left(y^{(4)}\right)
</span></p>
<p>Continue rest later.</p>
</div>
</div>
<p>Example again</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Taylor expand <span class="math inline">f(x) = (1+x)^{1/2}</span></p>
<p>We get clearly</p>
<p><span class="math display">
f^{(k)}(x) = \frac{(-1)^{k+1}}{2^k}(3\cdot 5\cdots (2k-3))(1+x)^{\frac{-2k-1}{2}}
</span></p>
<p>So our taylor expansion</p>
<p><span class="math display">
f(x) = (1+x)^{1/2} = 1 + \frac{x}{2} - \frac{1}{2^2}\frac{x^2}{2!} + \frac{3}{2^3}\frac{x^3}{3!} \cdots + \frac{-1^{k+1}}{2^k}(1\cdot 3\cdot 5\cdots (2k-3))\frac{x^k}{k!}
</span></p>
</div>
</div>
</section>
<section id="newtons-method" class="level2">
<h2 class="anchored" data-anchor-id="newtons-method">Newtons method</h2>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Write the Newton Iteration to solve</p>
<p><span class="math display">
x = \cos x
</span></p>
<p>Note that</p>
<p><span class="math display">
f(x) = x - \cos x
</span></p>
<p><span class="math display">
f^\prime(x) = 1 + \sin x
</span></p>
<p>So</p>
<p><span class="math display">
x_{m+1} = x_m - \frac{x_m - \cos x_m}{1 + \sin x_m}
</span></p>
</div>
</div>
<p>Remember that the error of Newtons method is approximatly equal to the multiplicity of the root</p>
<p><span class="math display">
\varepsilon_{m+1} \approxeq \varepsilon_m^2 \bigg\lvert \frac{f^{\prime\prime}(a)}{2f^\prime(a)} \bigg\rvert
</span></p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Write the Newton Iteration to solve</p>
<p><span class="math display">
f(x) = x^\alpha\quad \alpha&gt;0
</span></p>
<p>We want to write newtons iteration with an initial guess <span class="math inline">x_0 \not = 0</span>, and find for what values of <span class="math inline">\alpha</span> does newtons iteration converge to root?</p>
<p>First</p>
<p><span class="math display">
x_{m+1} x_m - \frac{x^\alpha_m}{\alpha x^{\alpha-1}_m} = x_m\left(1-\frac{1}{\alpha}\right)
</span></p>
<p>This will converge if</p>
<p><span class="math display">
-1 &lt; 1 - \frac{1}{\alpha} &lt; 1
</span></p>
<p>Thus</p>
<p><span class="math display">
\frac{1}{\alpha} &lt; 2 \implies \alpha &gt; \frac{1}{2}
</span></p>
</div>
</div>
<p>Provided the multiplicity of the root is <span class="math inline">1</span>, it converges quadratically. Otherwise the newton method converges linearly, with the rate equal to <span class="math inline">S = \frac{m-1}{m}</span>.</p>
<p>Lets assume you can’t calculate the derivative. We instead use the approximation</p>
<p><span class="math display">
f^\prime(x) \approx \frac{f(x + h)-f(x)}{h}
</span></p>
<p>Or we use the secant method.</p>
<p><span class="math display">
f^\prime(x_m) \approx \frac{f(x_m) - f(x_{m-1})}{x_m - x_{m-1}}
</span></p>
<p>This is useful when <span class="math inline">f(x_m)</span> is expensive to compute, but the disadvantage is the convergence is slightly slower.</p>
<p><span class="math display">
\varepsilon_{m+1} \approx \varepsilon_m^\alpha \bigg\lvert \frac{f^{\prime\prime}(r)}{2f^\prime(r)}\bigg\rvert
</span></p>
<p>Combination of Newton and Bisection</p>
<p>First we draw a secant line from the points <span class="math inline">a</span> to <span class="math inline">b</span>. This gives us an equation</p>
<p><span class="math display">
y = f(a) + (x - a)\frac{f(b)-f(a)}{b-a}
</span></p>
<p>Which gives us</p>
<p><span class="math display">
x = \frac{a(f(b)-f(a))(b-a)}{f(b)-f(a)} = \frac{af(b)-bf(a)}{f(b)-f(a)}
</span></p>
</section>
<section id="interpolation" class="level2">
<h2 class="anchored" data-anchor-id="interpolation">Interpolation</h2>
<p>Given <span class="math inline">m</span> points <span class="math inline">(x_1,y_1)</span> through <span class="math inline">(x_m,y_m)</span>, we want to find a continous function <span class="math inline">P_{m-1}(x)</span> such that for all <span class="math inline">i = 1,\ldots,m</span></p>
<p><span class="math display">
P_{m-1}(x_i) = y_i
</span></p>
<p>We can find this function through <span style="color: blue"><strong>Lagrange interpolation</strong></span>.</p>
<p>Define</p>
<p><span class="math display">
L_k(x) = \frac{(x-x_1)(x-x_2)\cdots(x-x_{k-1})(x-x_{k+1})\cdots(x-x_m)}{(x_k-x_1)(x_k-x_2)\cdots(x_k - x_{k-1})(x_k - x_{k+1})\cdots(x_k - x_m)}
</span></p>
<p>We can clearly see that</p>
<p><span class="math display">
L_k(x_k) = 1,\quad L_k(x_i) = 0
</span></p>
<p>And that <span class="math inline">L_k</span> is a polynomial of degree <span class="math inline">m-1</span>. Here we can define</p>
<p><span class="math display">
P_{m-1}(x) = y_1L_1(x) + \cdots + y_mL_m(x)
</span></p>
<p>As a polynomial of degree <span class="math inline">\leq m-1</span>. This is called the <span style="color: blue"><strong>Lagrange polynomial</strong></span>. This gives us a function <span class="math inline">P_{m-1}(x)</span> such that</p>
<p><span class="math display">
P_{m-1}(x_i) = y_1L_1(x_i) + \cdots + y_mL_m(x_i) = y_i
</span></p>
<p>Which is pretty cool. But even better, this has the special property. Assume there exists some <em>true</em> function <span class="math inline">f(x)</span> that we are interpolating at a finite amount of points through <span class="math inline">P_{m-1}(x)</span>. Then we have the error</p>
<p><span class="math display">
y(x) - P_{m-1}(x) = \frac{y^{(m)}(c)}{m!}(x-x_1)(x-x_2)\cdots(x-x_m)
</span></p>
<p>Where <span class="math inline">c \in (x_1,x_m)</span>. Note that we can make <span class="math inline">m</span> as large as we want by adding more points, and due to the <span class="math inline">m!</span> in the denominator, we can make our <span class="math inline">P_{m-1}(x)</span> accurate incredibly quickly.</p>
<div class="callout callout-style-default callout-warning no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<p>Interpolate <span class="math inline">y(x) = \sin(x)</span> using interpolation points</p>
<p><span class="math display">
x_1 = 0\; x_2 = \frac{\pi}{2} \; x_3 = \pi
</span></p>
<p>And compute the error.</p>
<p>We can see</p>
<p><span class="math display">
y_1 = 0 \; y_2 = 1 \; y_3 = 0
</span></p>
<p>We therefore want a polynomial of degree two that interpolates the function.</p>
<p><span class="math display">
P_2(x) = y_1L_1 + y_2L_2 + y_3L_3
</span></p>
<p><span class="math display">
P_2(x) = (0)\frac{(x-\pi /2)(x-\pi)}{(0 - \pi/2)(0-\pi)} + (1)\frac{(x-0)(x-\pi)}{(\pi /2 - 0)(\pi /2 - \pi)} + (0)\frac{(x-0)(x- \pi /2)}{(\pi - 0) (\pi - \pi / 2)}
</span></p>
<p><span class="math display">
P_2(x) = -x(x-\pi)\frac{4}{\pi^2}
</span></p>
<p>Thus we have a function that approximates <span class="math inline">\sin(x)</span> using a parabola. Now we need to compute the error.</p>
<p><span class="math display">
\varepsilon = \frac{f^{(m)}(c)}{m!}(x-x_1)\cdots(x-x_m)
</span></p>
<p><span class="math display">
\varepsilon = \frac{-\cos(c)}{6}(x-0)\left(x-\frac{\pi}{2}\right)(x-\pi)
</span></p>
<p>Taking the absolute value, and the maximum value of cosine, we get our error <span class="math display">
|\varepsilon| \leq \frac{1}{6}|x\left(x-\frac{\pi}{2}\right)(x-\pi)|
</span></p>
<p>We can find the maximum error taking the derivative of <span class="math inline">\varepsilon</span></p>
<p><span class="math display">
\varepsilon^{\prime} = 3x^2 + 3\pi x + \frac{\pi^2}{2} = 0
</span></p>
<p>We get</p>
<p><span class="math display">
x_{\text{max}} = \frac{-3\pi \pm \pi \sqrt{3}}{6}
</span></p>
</div>
</div>
<p>Define the function</p>
<p><span class="math display">
h(x) = y(x) - P_{m-1}(x) - c(x-x_i)(x-x_2)\cdots(x-x_m)
</span></p>
<p>This has the property that for any <span class="math inline">i \in 1,\ldots,m</span></p>
<p><span class="math display">
h(x_i) = 0
</span></p>
<p>We can choose a constant <span class="math inline">c</span> such that for any <span class="math inline">x^* \in (x_1,x_m)</span></p>
<p><span class="math display">
h(x^*) = 0
</span></p>
<p>This gives us a function with <span class="math inline">m+1</span> zeros, specifically a polynomial of degree <span class="math inline">m+1</span>. We can use Rolle’s theorem in order to get a function <span class="math inline">h^\prime(x)</span> which has <span class="math inline">m</span> roots. We can repeat this process until <span class="math inline">h^{(m)}(x)</span> has one zero. That being</p>
<p><span class="math display">
h^{(m)}(c) = 0 = y^{(m)}(c) - 0 - C(m!)
</span></p>
<p>Thus</p>
<p><span class="math display">
C = \frac{y^{(m)}(c)}{m!}
</span></p>
<p>That directly leads to our error formula</p>
<p><span class="math display">
y(x) - P_{m-1}(x) = \frac{y^{(m)}(c)}{m!}(x-x_1)(x-x_2)\cdots(x-x_m)
</span></p>
<p>You can choose specific <span class="math inline">x_1</span>,<span class="math inline">x_2</span>,<span class="math inline">x_3</span> in order to make the error as small as possible.</p>
</section>
<section id="error" class="level2">
<h2 class="anchored" data-anchor-id="error">Error</h2>
<p>Suppose that we have an error</p>
<p><span class="math display">
\varepsilon = \frac{h^3}{4}f^{(4)}(c_1) + \frac{h^3}{8}f^{\prime\prime}(c_2)
</span></p>
<p>We have a simplified expression</p>
<p><span class="math display">
\varepsilon = h^3(\frac{1}{4}+\frac{1}{8})f^{\prime\prime}(c)
</span></p>
<p>For some <span class="math inline">c</span>.</p>
</section>
<section id="multi-panel-integration-formula" class="level2">
<h2 class="anchored" data-anchor-id="multi-panel-integration-formula">Multi-panel integration formula</h2>
<p><span class="math display">
\int\limits^b_a f(s) ds = \int\limits^{a+h}_a f(s) ds + \int\limits^{a+2h}_{a+h} f(s) ds \cdots \int\limits^{b}_{b-h} f(s) ds
</span></p>
<p>Using the formula from last class, this is equal too</p>
<p><span class="math display">
\int\limits_a^{a+h}f(s)ds = \frac{h}{2}(f(a)+f(a+h))-\frac{h^3}{12}
f^{\prime\prime}(c_1)
</span></p>
<p>Expanding our initial integral, we can see it’s telescoping. This gives</p>
<p><span class="math display">
\int\limits^b_a f(s) ds = \frac{h}{2}\left(f(a)+2f(a+h)\cdots2f(b-h) + f(b)\right) - \varepsilon
</span></p>
<p><span class="math display">
\varepsilon = \frac{h^3}{12}(f^{\prime\prime}(c_1)\cdots f^{\prime\prime}(c_m))
</span></p>
<p>Using the generalized intermediate value theorem, we can simplify</p>
<p><span class="math display">
\varepsilon= \frac{h^3}{12}mf^{\prime\prime}(c) = \frac{(a-b)h^2}{12}f^{\prime\prime}(c)
</span></p>
<p>Which gives us an error for the trapezoidal formula.</p>
<p>for what m is the error less than <span class="math inline">10^{-6}</span>/</p>
</section>
<section id="simpson-integration" class="level2">
<h2 class="anchored" data-anchor-id="simpson-integration">Simpson integration</h2>
<p><span class="math display">
\mathrlap{\int\limits_x^{x+2h}}\quad\quad f(s) \,ds = \frac{h^3}{3}(f(x) + 4f(x+h) + f(x+2h)) - \frac{h^5}{90}f^{(4)}(c)
</span></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>